//Author: Thor Tronrud <ttronrud@starfishmedical.com>
//Main as test-bed for filter state save/load
//Also can show how Rs will converge with iterations
//of PT
//Also includes hardcoded ECG data from contiguous sections
//of the same recording

#include "PanTompkinsEmbedded.h"
#include <stdio.h>
#define RS_MAX_LEN 32
#define ECG_SIG_LEN 2000
//Example signals to use, from the AHA database
//with length of 2000 samples at 250Hz
dataType SIGNAL1[] = {-121, -114, -117, -110, -109, -95, -77, -100, -102, -101, -105, -97, -81, -79, -65, -59, -57, -66, -65, -55, -47, -50, -56, -47, -45, -43, -61, -55, -38, -23, -23, -25, -26, -43, -31, -29, -33, -26, -26, -29, -19, -9, -9, -17, -15, -8, -1, 11, 15, 1, -5, -6, 8, -3, -5, -5, -22, -29, -21, -13, -13, -11, -7, -9, -9, -15, -13, -13, -13, -19, -33, -33, -26, -31, -33, -31, -33, -25, -29, -37, -31, -45, -47, -47, -50, -51, -55, -55, -57, -55, -61, -65, -61, -61, -57, -61, -70, -57, -57, -63, -65, -57, -65, -71, -69, -57, -61, -74, -94, -90, -77, -69, -61, -63, -61, -54, -47, -40, -49, -37, -21, 1, 7, 29, 23, 3, -21, -42, -29, -7, -21, -45, -73, -90, -98, -105, -126, -125, -129, -114, -118, -124, -129, -125, -126, -121, -130, -158, -138, -86, 48, 199, 373, 504, 511, 387, 147, -142, -288, -339, -373, -392, -387, -387, -367, -321, -264, -229, -207, -185, -179, -181, -166, -162, -142, -141, -144, -137, -137, -141, -148, -146, -141, -135, -137, -137, -141, -141, -141, -138, -138, -137, -133, -125, -125, -126, -116, -109, -106, -109, -109, -105, -105, -105, -114, -105, -102, -102, -101, -106, -102, -97, -107, -103, -112, -110, -111, -110, -109, -110, -114, -116, -115, -113, -106, -110, -112, -109, -106, -102, -105, -106, -103, -110, -110, -109, -108, -111, -121, -122, -125, -127, -130, -134, -131, -129, -129, -126, -133, -137, -140, -139, -141, -135, -137, -138, -146, -139, -141, -146, -144, -150, -150, -153, -158, -160, -160, -162, -170, -170, -169, -174, -169, -170, -172, -177, -195, -184, -184, -185, -196, -194, -201, -194, -193, -196, -201, -205, -207, -195, -196, -192, -182, -188, -182, -180, -183, -167, -150, -147, -145, -125, -121, -126, -141, -158, -170, -156, -144, -149, -177, -200, -224, -252, -250, -250, -251, -256, -246, -246, -248, -251, -245, -247, -258, -289, -300, -275, -185, -23, 179, 373, 493, 465, 328, 51, -267, -407, -408, -403, -419, -435, -423, -385, -347, -315, -292, -277, -271, -273, -268, -259, -260, -249, -262, -247, -248, -246, -251, -243, -243, -243, -241, -235, -239, -230, -231, -224, -233, -231, -227, -220, -214, -214, -209, -209, -212, -212, -207, -190, -192, -194, -181, -180, -185, -181, -180, -173, -183, -174, -177, -174, -170, -174, -170, -172, -173, -167, -166, -164, -166, -168, -157, -153, -153, -150, -140, -142, -146, -147, -146, -138, -137, -145, -142, -142, -152, -159, -170, -170, -174, -177, -182, -181, -168, -174, -184, -188, -194, -197, -192, -192, -181, -190, -196, -189, -185, -187, -194, -191, -190, -186, -190, -189, -199, -196, -190, -196, -202, -201, -205, -203, -198, -199, -205, -213, -209, -210, -209, -211, -201, -197, -202, -202, -203, -205, -204, -211, -209, -211, -214, -209, -202, -201, -192, -197, -185, -184, -178, -175, -146, -149, -142, -129, -114, -121, -138, -153, -162, -135, -138, -137, -159, -182, -206, -229, -229, -233, -234, -235, -224, -228, -214, -220, -226, -226, -231, -256, -273, -262, -186, -53, 135, 337, 479, 496, 383, 141, -182, -361, -380, -375, -381, -394, -399, -369, -322, -288, -260, -249, -243, -241, -233, -239, -225, -220, -209, -205, -198, -198, -193, -192, -188, -185, -173, -173, -176, -174, -167, -166, -174, -171, -165, -159, -161, -146, -143, -139, -136, -132, -133, -121, -118, -112, -110, -110, -106, -102, -101, -93, -97, -102, -98, -86, -90, -90, -87, -81, -85, -80, -77, -79, -69, -70, -63, -55, -63, -57, -47, -42, -42, -43, -45, -40, -47, -43, -41, -42, -45, -45, -48, -55, -53, -65, -67, -69, -70, -77, -82, -85, -86, -90, -90, -77, -85, -86, -85, -91, -93, -89, -86, -90, -93, -87, -89, -85, -77, -86, -86, -82, -85, -82, -83, -89, -87, -91, -89, -83, -82, -85, -79, -78, -71, -77, -79, -82, -78, -72, -74, -74, -79, -79, -81, -78, -74, -66, -69, -61, -63, -53, -53, -40, -39, -27, -9, 3, 37, 35, 15, -9, -33, -37, -15, -13, -13, -31, -65, -81, -89, -81, -77, -86, -86, -82, -89, -85, -72, -80, -75, -105, -121, -114, -66, 42, 215, 403, 563, 615, 527, 319, 27, -194, -259, -261, -256, -269, -279, -262, -216, -167, -130, -105, -98, -91, -89, -85, -73, -74, -70, -65, -49, -53, -61, -57, -55, -48, -41, -23, -35, -27, -18, -15, -29, -22, -9, -7, -7, -21, -17, 1, 11, 17, 25, 23, 25, 43, 42, 53, 55, 55, 53, 61, 65, 51, 57, 65, 47, 51, 49, 49, 64, 73, 73, 75, 71, 75, 72, 79, 91, 99, 88, 91, 95, 105, 110, 113, 107, 99, 97, 97, 95, 95, 97, 101, 97, 83, 87, 75, 64, 63, 77, 69, 51, 49, 45, 57, 57, 67, 72, 56, 57, 57, 55, 57, 51, 45, 55, 59, 61, 59, 43, 35, 47, 51, 47, 51, 54, 49, 59, 47, 33, 24, 34, 40, 59, 63, 55, 49, 33, 39, 45, 43, 47, 49, 49, 57, 51, 66, 67, 72, 65, 63, 83, 81, 99, 112, 111, 131, 143, 152, 147, 125, 111, 117, 136, 115, 101, 93, 59, 51, 47, 46, 57, 45, 25, 31, 35, 25, 48, 51, 33, 31, 19, 27, 97, 203, 341, 501, 646, 678, 555, 340, 59, -81, -141, -210, -223, -195, -167, -174, -150, -101, -61, -23, 3, 11, 9, 9, 35, 43, 64, 64, 49, 49, 63, 73, 85, 97, 75, 65, 71, 68, 67, 85, 96, 97, 98, 105, 93, 88, 103, 107, 109, 129, 131, 137, 137, 129, 125, 140, 140, 131, 145, 139, 133, 145, 145, 144, 153, 152, 135, 139, 141, 137, 145, 155, 156, 145, 145, 157, 161, 161, 171, 169, 146, 151, 151, 159, 153, 152, 151, 147, 151, 145, 144, 143, 139, 143, 141, 129, 128, 129, 139, 132, 136, 128, 125, 123, 127, 130, 129, 131, 132, 133, 138, 131, 125, 126, 125, 123, 120, 119, 120, 123, 113, 109, 93, 97, 99, 104, 97, 89, 91, 94, 89, 95, 91, 93, 95, 93, 97, 89, 91, 91, 91, 91, 91, 91, 95, 101, 113, 115, 120, 129, 143, 141, 159, 173, 176, 185, 188, 187, 176, 155, 147, 144, 167, 165, 140, 115, 97, 77, 51, 57, 61, 62, 67, 69, 73, 75, 73, 73, 69, 53, 23, 31, 83, 201, 365, 559, 714, 764, 688, 459, 139, -70, -117, -117, -138, -152, -152, -125, -69, -26, 11, 33, 48, 47, 54, 57, 67, 91, 88, 87, 89, 97, 104, 93, 98, 95, 105, 104, 113, 129, 123, 127, 131, 129, 128, 139, 137, 139, 145, 157, 155, 161, 167, 169, 175, 181, 175, 179, 183, 183, 187, 187, 189, 187, 184, 192, 194, 193, 195, 189, 189, 195, 189, 192, 193, 196, 203, 197, 195, 202, 195, 195, 204, 211, 216, 211, 217, 211, 207, 203, 203, 209, 200, 195, 193, 187, 184, 179, 179, 177, 179, 170, 173, 165, 168, 171, 166, 165, 165, 161, 155, 161, 159, 162, 159, 149, 153, 145, 147, 151, 153, 152, 145, 149, 149, 145, 139, 139, 145, 138, 139, 144, 141, 143, 139, 137, 137, 137, 128, 125, 125, 127, 129, 133, 123, 123, 123, 125, 129, 135, 139, 145, 157, 161, 176, 183, 179, 200, 205, 197, 179, 167, 145, 163, 177, 170, 157, 120, 95, 78, 71, 63, 65, 73, 69, 72, 73, 77, 75, 71, 59, 42, 13, 19, 77, 198, 361, 560, 737, 800, 735, 527, 184, -65, -113, -105, -101, -122, -129, -96, -55, -16, 16, 27, 35, 29, 35, 51, 55, 56, 65, 64, 67, 71, 67, 77, 73, 73, 85, 85, 91, 91, 91, 95, 107, 113, 113, 115, 114, 119, 122, 129, 130, 129, 129, 139, 139, 141, 147, 149, 153, 153, 151, 155, 153, 157, 165, 161, 173, 170, 187, 189, 203, 201, 200, 205, 216, 229, 231, 234, 251, 257, 241, 189, 170, 172, 178, 187, 202, 195, 192, 184, 173, 169, 161, 153, 137, 135, 125, 120, 115, 113, 103, 114, 111, 104, 112, 101, 104, 105, 107, 105, 99, 81, 50, 49, 125, 253, 441, 661, 842, 909, 781, 507, 175, -25, -87, -109, -133, -150, -139, -103, -59, -27, -1, 30, 33, 27, 24, 35, 31, 35, 41, 55, 53, 48, 53, 47, 47, 53, 51, 56, 54, 61, 57, 59, 63, 57, 73, 70, 75, 75, 83, 91, 91, 103, 111, 106, 112, 117, 121, 115, 117, 121, 127, 137, 147, 145, 137, 136, 147, 147, 147, 159, 153, 161, 169, 179, 177, 181, 201, 207, 205, 207, 192, 185, 179, 183, 189, 191, 178, 167, 149, 147, 149, 141, 131, 137, 131, 115, 107, 101, 102, 107, 106, 105, 103, 99, 101, 93, 89, 85, 88, 75, 79, 85, 90, 91, 83, 85, 75, 69, 73, 67, 77, 81, 70, 71, 73, 73, 65, 63, 61, 69, 75, 73, 71, 64, 67, 63, 59, 64, 81, 72, 67, 69, 77, 81, 69, 64, 49, 51, 61, 72, 61, 67, 61, 59, 71, 61, 55, 55, 64, 59, 67, 71, 67, 67, 71, 67, 59, 53, 51, 50, 69, 69, 67, 75, 75, 85, 95, 99, 113, 129, 149, 153, 147, 133, 117, 111, 131, 137, 131, 111, 63, 39, 27, 29, 23, 15, 19, 25, 21, 35, 35, 37, 29, 5, -7, 7, 59, 143, 265, 429, 584, 662, 583, 395, 111, -95, -148, -198, -241, -230, -227, -220, -192, -133, -97, -65, -45, -34, -17, -7, 13, 25, 21, 15, 17, 7, 7, 13, 15, 23, 33, 35, 45, 51, 49, 47, 47, 43, 49, 51, 45, 45, 65, 83, 99, 85, 61, 49, 65, 70, 69, 75, 86, 83, 81, 77, 83, 77, 89, 97, 97, 95, 91, 82, 80, 91, 105, 95, 97, 99, 99, 107, 105, 107, 119, 130, 129, 135, 145, 155, 161, 165, 173, 167, 173, 183, 203, 225, 221, 237, 243, 211, 171, 143, 101, 97, 107, 114, 137, 125, 111, 115, 120, 109, 107, 90, 75, 71, 58, 67, 67, 75, 83, 67, 64, 55, 55, 59, 35, 1, -13, 1, 57, 169, 328, 520, 668, 685, 580, 365, 67, -125, -197, -219, -236, -231, -206, -176, -134, -89, -47, -35, -7, 3, -5, -7, -2, 9, 5, 2, -1, 3, 11, 19, 35, 19, 15, 9, 11, 27, 31, 33, 24, 25, 30, 43, 59, 54, 35, 31, 33, 37, 47, 51, 49, 43, 43, 33, 35, 39, 39, 29, 37, 43, 35, 37, 35, 35, 35, 43, 43, 47, 51, 59, 57, 59, 55, 65, 73, 73, 82, 83, 83, 87, 91, 85, 90, 90, 83, 81, 85, 86, 81, 77, 73, 73, 61, 71, 67, 66, 64, 71, 67, 67, 58, 61, 61, 59, 57, 57, 57, 49, 55, 51, 51, 45, 51, 51, 47, 45, 40, 37, 41, 51, 47, 41, 35, 41, 39, 31, 37, 43, 39, 31, 31, 27, 25, 29, 31, 23, 17, 15, 29, 25, 29, 35, 35, 35, 27, 35, 33, 33, 32, 29, 24, 33, 33, 31, 43, 27, 35, 35, 31, 37, 43, 40, 41, 51, 47, 55, 67, 66, 81, 91, 99, 107, 117, 130, 131, 113, 107, 90, 83, 99, 97, 95, 66, 49, 24, 3, 7, 3, 11, 11, 17, 19, 13, 22, 5, -15, -41, -59, -25, 61, 213, 402, 607, 732, 725, 613, 326, -5, -150, -141, -141, -162, -185, -164, -124, -75, -47, -37, -21, -17, -23, -11, -15, -3, 3, 10, 9, 17, 11, 11, 18, 19, 23, 23, 23, 23, 22, 31, 37, 41, 46, 47, 51, 44, 49, 55, 48, 64, 70, 67, 65, 73, 75, 83, 87, 85, 81, 87, 89, 88, 91, 99, 97, 93, 95, 100, 108, 105, 106, 104, 107, 103, 105, 105, 109, 107, 109, 122, 126, 123, 125, 135, 142, 137, 139, 144, 144, 147, 141, 139, 135, 128, 131, 123, 117, 115, 107, 109, 104, 103, 89, 91, 89, 87, 90, 91, 85, 85, 80, 85, 75, 57, 53, 56, 58, 51, 51, 49};
dataType SIGNAL2[] = {49, 43, 43, 43, 37, 41, 39, 37, 39, 34, 37, 31, 31, 30, 25, 23, 25, 25, 19, 19, 21, 26, 17, 19, 22, 19, 19, 11, 11, 17, 18, 19, 15, 15, 7, 15, 19, 23, 23, 27, 39, 41, 53, 65, 72, 81, 79, 93, 97, 87, 67, 51, 53, 72, 75, 64, 34, 13, -5, -25, -37, -39, -35, -37, -31, -33, -29, -35, -40, -53, -77, -92, -97, -21, 83, 249, 441, 613, 678, 609, 413, 82, -166, -210, -193, -193, -218, -221, -195, -154, -121, -84, -65, -61, -61, -59, -54, -42, -37, -43, -30, -21, -29, -25, -29, -18, -19, -15, -13, -3, -3, 1, 10, 11, 11, 5, 9, 17, 17, 22, 21, 23, 29, 35, 35, 41, 31, 35, 33, 39, 40, 37, 43, 43, 43, 35, 37, 41, 51, 51, 41, 45, 41, 49, 43, 31, 39, 43, 47, 47, 55, 59, 59, 63, 61, 69, 75, 79, 81, 72, 78, 75, 73, 73, 67, 69, 65, 63, 54, 51, 45, 53, 43, 43, 41, 55, 47, 47, 47, 37, 27, 19, 22, 23, 21, 21, 17, 19, 17, 11, 18, 9, 7, 5, -1, 1, 2, -1, 1, 3, 1, -1, -2, -10, -5, -13, -7, -9, -13, -11, -9, -13, -7, -7, -13, -13, -15, -15, -13, -15, -15, -21, -15, -23, -13, -14, -9, -11, -1, 19, 17, 25, 35, 56, 65, 81, 83, 67, 61, 47, 40, 43, 61, 45, 25, -5, -33, -49, -55, -57, -63, -53, -45, -48, -48, -47, -53, -56, -69, -90, -108, -86, 1, 151, 340, 526, 633, 612, 465, 179, -111, -237, -232, -217, -238, -248, -248, -204, -165, -133, -102, -87, -77, -85, -81, -77, -71, -71, -77, -63, -59, -53, -50, -43, -57, -57, -49, -47, -45, -25, -25, -29, -29, -24, -7, -1, -3, -1, -9, -18, -17, -7, -5, 1, 9, 13, 9, 11, 9, 19, 31, 33, 31, 17, 11, 23, 33, 31, 27, 33, 31, 35, 35, 27, 35, 40, 29, 45, 47, 53, 59, 51, 56, 57, 67, 65, 65, 64, 57, 55, 54, 53, 59, 61, 59, 57, 51, 43, 41, 40, 45, 37, 31, 17, 3, 7, 19, 11, 15, 19, 9, 11, 1, -6, 1, 3, 5, -1, 15, -1, -19, -17, -13, -15, -21, -25, -29, -23, -23, -22, -13, -13, -23, -23, -25, -25, -37, -47, -47, -31, -29, -30, -43, -52, -50, -43, -27, -21, -30, -43, -55, -57, -50, -29, -29, -10, -24, -37, -33, -22, -10, 3, 16, 27, 39, 57, 55, 11, -5, 19, 23, 15, -15, -33, -55, -85, -101, -97, -90, -109, -101, -85, -81, -82, -73, -82, -123, -129, -118, -69, 23, 166, 330, 473, 531, 443, 249, -7, -206, -274, -313, -376, -384, -373, -342, -313, -254, -214, -193, -187, -186, -177, -158, -146, -138, -130, -130, -150, -153, -153, -142, -148, -122, -97, -98, -134, -159, -138, -130, -126, -117, -106, -130, -117, -117, -125, -113, -113, -134, -125, -123, -110, -89, -99, -117, -129, -140, -137, -119, -105, -98, -120, -141, -138, -118, -127, -137, -138, -150, -143, -114, -101, -121, -147, -150, -136, -116, -129, -130, -133, -133, -121, -117, -128, -122, -106, -116, -138, -149, -158, -153, -141, -137, -141, -118, -130, -155, -172, -174, -174, -178, -173, -166, -161, -144, -149, -175, -190, -190, -187, -192, -214, -219, -215, -214, -216, -230, -232, -230, -234, -241, -233, -241, -242, -241, -244, -250, -246, -254, -254, -263, -258, -256, -259, -264, -255, -269, -268, -276, -270, -273, -274, -273, -273, -278, -270, -274, -282, -273, -274, -265, -257, -249, -252, -247, -237, -218, -214, -203, -201, -198, -223, -240, -251, -237, -231, -237, -247, -276, -310, -327, -340, -340, -345, -340, -345, -337, -343, -331, -345, -346, -369, -386, -387, -363, -279, -136, 43, 213, 313, 275, 123, -149, -420, -531, -559, -565, -583, -589, -583, -545, -501, -455, -435, -419, -412, -402, -399, -394, -386, -379, -381, -371, -376, -373, -369, -369, -356, -363, -361, -367, -359, -352, -349, -349, -359, -359, -363, -361, -357, -355, -347, -340, -346, -340, -329, -330, -336, -332, -325, -325, -328, -323, -329, -331, -325, -329, -320, -324, -325, -325, -326, -326, -324, -327, -326, -334, -332, -324, -321, -319, -318, -317, -318, -310, -312, -313, -311, -308, -313, -316, -317, -312, -323, -320, -322, -327, -328, -330, -333, -339, -338, -344, -345, -347, -340, -347, -352, -351, -351, -345, -351, -360, -358, -358, -360, -363, -369, -377, -375, -373, -379, -377, -382, -383, -385, -381, -383, -387, -385, -385, -386, -382, -383, -382, -385, -384, -383, -381, -391, -397, -393, -385, -390, -392, -392, -391, -392, -394, -392, -383, -375, -367, -375, -363, -347, -347, -340, -332, -311, -316, -301, -301, -305, -330, -340, -347, -322, -315, -324, -353, -375, -399, -413, -412, -419, -411, -415, -402, -405, -403, -401, -403, -397, -431, -455, -467, -431, -337, -194, 9, 200, 304, 269, 115, -176, -469, -585, -573, -561, -581, -595, -573, -535, -487, -467, -448, -433, -439, -431, -427, -413, -409, -407, -397, -403, -401, -397, -393, -385, -385, -385, -388, -375, -378, -371, -375, -363, -361, -361, -352, -361, -360, -356, -352, -347, -347, -342, -337, -337, -331, -330, -333, -337, -321, -320, -324, -314, -313, -310, -308, -307, -314, -311, -306, -299, -304, -302, -299, -293, -290, -288, -288, -281, -270, -269, -268, -258, -259, -256, -260, -256, -259, -251, -254, -253, -248, -254, -261, -266, -269, -273, -270, -273, -279, -281, -285, -290, -287, -279, -282, -284, -280, -269, -277, -268, -265, -268, -266, -270, -260, -269, -273, -270, -273, -274, -264, -265, -274, -270, -270, -274, -269, -270, -261, -261, -258, -266, -267, -266, -266, -262, -264, -265, -267, -260, -269, -266, -261, -266, -264, -258, -256, -250, -258, -258, -256, -247, -239, -241, -230, -223, -210, -202, -185, -185, -165, -155, -160, -177, -197, -205, -189, -173, -184, -209, -232, -249, -268, -265, -273, -262, -265, -261, -262, -254, -252, -256, -250, -262, -288, -286, -257, -162, -9, 181, 367, 455, 406, 227, -65, -330, -425, -409, -413, -415, -427, -422, -371, -333, -296, -281, -263, -264, -263, -251, -241, -239, -239, -236, -222, -227, -220, -220, -218, -206, -196, -197, -191, -196, -194, -189, -182, -179, -168, -157, -153, -149, -146, -150, -134, -130, -129, -133, -133, -121, -119, -115, -128, -129, -114, -107, -117, -109, -99, -95, -94, -103, -97, -93, -94, -96, -90, -91, -87, -86, -78, -75, -77, -69, -63, -45, -57, -55, -49, -37, -37, -31, -39, -42, -41, -40, -45, -40, -39, -45, -51, -49, -61, -57, -57, -62, -53, -53, -57, -61, -61, -64, -66, -55, -71, -59, -69, -67, -69, -69, -64, -75, -87, -85, -79, -69, -61, -73, -73, -79, -79, -81, -77, -77, -78, -77, -77, -79, -69, -78, -75, -69, -89, -90, -86, -85, -89, -86, -80, -77, -85, -66, -50, -66, -82, -88, -80, -76, -73, -53, -37, -33, -37, -15, 9, 8, 19, 31, 25, 7, -7, 1, 14, 41, 17, -19, -43, -77, -82, -83, -85, -94, -88, -79, -69, -73, -69, -83, -73, -80, -90, -63, -21, 59, 175, 337, 490, 580, 528, 344, 73, -153, -243, -287, -306, -315, -286, -282, -251, -212, -169, -147, -110, -99, -101, -106, -85, -85, -70, -61, -69, -73, -47, -41, -57, -41, -37, -33, -15, -19, -35, -41, -47, -41, -29, -17, -5, 8, 5, -5, -21, -13, 1, 19, 31, 45, 19, -8, -7, -5, -1, 9, 25, 21, 11, 3, 5, 19, 19, 15, 11, 11, 11, 25, 51, 45, 31, 25, 39, 43, 41, 35, 40, 42, 51, 47, 59, 49, 37, 38, 51, 50, 53, 59, 45, 41, 29, 37, 39, 31, 27, 19, 25, 29, 27, 31, 27, 23, 25, 27, 27, 19, 18, 19, 19, 15, 11, 11, 9, 8, 5, 2, 7, 3, -5, -1, -3, -8, -9, -8, -1, -2, -6, -7, -9, -11, -7, -5, -13, -11, -8, -9, -5, -7, -3, -5, -3, 0, 1, 1, 3, 10, 15, 5, 9, 23, 37, 41, 54, 64, 75, 85, 91, 93, 88, 72, 59, 45, 61, 79, 67, 57, 27, 7, -15, -37, -22, -25, -21, -25, -17, -18, -13, -13, -14, -15, -45, -53, -35, 45, 165, 328, 523, 665, 696, 589, 367, 49, -147, -194, -210, -210, -223, -224, -205, -145, -101, -65, -53, -37, -31, -23, -21, -15, -5, -5, 1, 21, 17, 9, 10, 24, 19, 29, 31, 35, 39, 42, 48, 49, 49, 41, 53, 57, 57, 63, 71, 67, 75, 88, 89, 87, 95, 99, 95, 99, 109, 107, 104, 111, 115, 121, 121, 120, 121, 125, 120, 123, 125, 123, 127, 125, 127, 136, 133, 131, 134, 143, 147, 147, 147, 143, 143, 139, 141, 143, 147, 145, 147, 141, 137, 141, 138, 141, 133, 133, 129, 122, 121, 123, 122, 121, 126, 119, 125, 126, 128, 117, 120, 115, 115, 115, 114, 115, 115, 104, 110, 107, 105, 106, 103, 97, 107, 95, 99, 99, 95, 91, 95, 99, 95, 99, 95, 95, 97, 89, 91, 93, 93, 89, 91, 89, 93, 93, 95, 99, 109, 111, 113, 123, 131, 136, 143, 149, 164, 169, 185, 193, 186, 171, 141, 145, 161, 179, 169, 141, 114, 97, 70, 59, 64, 69, 65, 75, 75, 70, 69, 75, 75, 63, 35, 15, 39, 120, 275, 465, 667, 792, 798, 650, 363, 41, -109, -98, -91, -108, -127, -121, -69, -23, 11, 29, 41, 45, 53, 65, 75, 83, 89, 95, 89, 97, 95, 101, 105, 105, 113, 119, 127, 127, 133, 133, 136, 139, 145, 151, 155, 155, 167, 157, 158, 173, 173, 181, 187, 191, 197, 197, 207, 204, 200, 209, 208, 211, 207, 216, 222, 231, 233, 243, 257, 265, 267, 271, 265, 287, 296, 299, 313, 317, 305, 262, 236, 227, 234, 249, 253, 253, 253, 239, 225, 229, 223, 209, 197, 192, 181, 185, 182, 183, 187, 185, 179, 171, 174, 179, 177, 180, 179, 175, 176, 165, 145, 136, 189, 304, 488, 709, 905, 1014, 929, 675, 331, 83, -5, -13, -37, -45, -49, -17, 31, 67, 96, 105, 121, 129, 128, 131, 137, 134, 135, 136, 143, 149, 151, 153, 153, 157, 159, 163, 171, 171, 167, 175, 173, 187, 189, 185, 185, 185, 185, 197, 193, 209, 210, 211, 210, 213, 221, 226, 229, 225, 227, 229, 241, 242, 236, 235, 245, 256, 272, 281, 285, 277, 278, 289, 296, 299, 306, 310, 308, 307, 305, 306, 318, 313, 303, 285, 287, 287, 285, 271, 267, 256, 255, 247, 233, 231, 221, 222, 219, 227, 219, 217, 209, 201, 207, 207, 223, 223, 221, 208, 205, 198, 205, 215, 195, 190, 185, 192, 197, 197, 195, 193, 194, 193, 187, 181, 171, 185, 193, 189, 195, 203, 196, 177, 171, 163, 171, 166, 171, 173, 171, 163, 171, 183, 179, 173, 168, 179, 165, 166, 167, 163, 187, 191, 163, 153, 153, 165, 171, 177, 184, 185, 179, 177, 157, 163, 171, 177, 175, 192, 195, 195, 199, 189, 199, 211, 219, 235, 265, 289, 277, 241, 207, 200, 205, 223, 241, 217, 189, 155, 135, 137, 123, 107, 125, 141, 127, 121, 125, 141, 133, 127, 85, 89, 143, 223, 322, 461, 628, 743, 722, 580, 315, 67, -27, -77, -137, -168, -148, -125, -93, -56, -25, -3, 11, 59, 99, 97, 65, 59, 74, 95, 94, 88, 83, 81, 91, 81, 89, 99, 101, 127, 155, 130, 95, 90, 89, 97, 109, 129, 152, 152, 136, 117, 104, 115, 127, 152, 163, 151, 123, 113, 123, 127, 134, 139, 125, 118, 139, 149, 139, 121, 119, 123, 131, 152, 157, 143, 139, 145, 159, 179, 169, 145, 139, 145, 159, 167, 163, 163, 157, 155, 165, 161, 159, 157, 147, 149, 152, 154, 143, 131, 139, 136, 135, 131, 133, 131, 133, 129, 125, 127, 115, 107, 109, 109, 103, 99, 99, 95, 97, 90, 83, 81, 79, 78, 75, 67, 64, 56, 55, 59, 51};

int this_Rs[RS_MAX_LEN] = {0};

//Shows the "real time" PT R-peak detection
//Mimic behaviour of a main-loop, where it grabs the
//next element of a signal, and passes it to the 
//single-step method
int main()
{
	PanTompkins_init();
	for(int j = 0; j < 3; j++)
	{
		printf("Beginning iteration %d:\n",j+1);
		for(int i = 0; i < 2000; i++)
		{
			if(PanTompkins_SingleStep(SIGNAL1[i]))
			{
				printf("R detected at %d!\n",i-14);
			}
		}
	}
	int offset = 2000;
	printf("Using SIGNAL2:\n");
	for(int i = 0; i < 2000; i++)
	{
		if(PanTompkins_SingleStep(SIGNAL2[i]))
		{
			printf("R detected at %d!\n",i-14+offset);
		}
	}
	return 0;
}

